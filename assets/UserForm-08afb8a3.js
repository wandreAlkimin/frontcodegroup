import{D as d}from"./DataService-517babb4.js";import{f as g,o as u,c,a as t,t as h,g as n,v as m,h as f,j as p}from"./index-cf4a1cf1.js";import{_ as b}from"./_plugin-vue_export-helper-c27b6911.js";const v={data(){return{form:{id:null,nome:"",email:"",dt_nascimento:"",password:"",telefone:""},perfil_img:null,userId:null,perfil_img_preview:null,perfil_img_carregado:null,idade:null}},async created(){this.checkId()},mounted(){M.updateTextFields()},updated(){M.updateTextFields()},methods:{checkId(){const s=this.$route.params.id;s&&this.getUser(s)},async getUser(s){try{d.getUser(s).then(e=>{console.log(e.data.data),this.form=e.data.data,this.userId=e.data.data.id,this.perfil_img_carregado=e.data.data.perfil_img,this.formataDateIdade()}).catch(e=>{console.log(e)})}catch(e){console.error("Erro ao buscar dados do usuário",e)}},handleFileChange(s){const e=s.target.files[0];e&&(this.perfil_img=e,this.perfil_img_preview=URL.createObjectURL(e))},async submitForm(){this.userId?await this.updateUser():await this.createUser()},async createUser(){try{d.createUser(this.form).then(s=>{let e=s.data.data,o=s.data.message;this.perfil_img?d.uploadImgUser(e,this.perfil_img).then(l=>{this.perfil_img=null,this.perfil_img_preview=null,this.perfil_img_carregado=l.data.data;let a=l.data.message;M.toast({html:a,classes:"green toast-bottom-left"}),this.$router.push("/cadastros")}).catch(l=>{let a=s.data.message;M.toast({html:a,classes:"red toast-bottom-left"})}):(M.toast({html:o,classes:"green toast-bottom-left"}),this.$router.push("/cadastros"))}).catch(s=>{let e=response.data.message;M.toast({html:e,classes:"red toast-bottom-left"})})}catch(s){console.error("Erro ao criar usuário",s)}},async updateUser(){try{d.updateUser(this.userId,this.form).then(s=>{let e=s.data.result;if(this.perfil_img&&e===!0)d.uploadImgUser(this.userId,this.perfil_img).then(o=>{this.perfil_img=null,this.perfil_img_preview=null,this.perfil_img_carregado=o.data.data;let l=o.data.message;M.toast({html:l,classes:"green toast-bottom-left"})}).catch(o=>{let l=s.data.message;M.toast({html:l,classes:"red toast-bottom-left"})});else{let o=s.data.message;M.toast({html:o,classes:"green toast-bottom-left"})}}).catch(s=>{let e=response.data.message;M.toast({html:e,classes:"red toast-bottom-left"})})}catch(s){console.error("Erro ao buscar dados do usuário",s)}},formataDateIdade(){let s=this.form.dt_nascimento;const[e,o,l]=s.split("-"),a=`${l}/${o}/${e}`,r=this.calcularIdade(e,o,l);return`${a} (Idade: ${r} anos)`},calcularIdade(s,e,o){const l=new Date,a=new Date(s,e-1,o);this.idade=l.getFullYear()-a.getFullYear(),this.idade=this.idade+" anos"}}},y={class:"container"},I={class:"input-field"},U=t("label",{for:"nome"},"Nome",-1),x={class:"input-field"},w=t("label",{for:"email"},"Email",-1),D={class:"input-field"},F=t("label",{for:"dt_nascimento"},"Data de Nascimento",-1),k={class:"input-field"},V=t("label",{for:"idade"},"Idade: ",-1),C={class:"input-field"},E=t("label",{for:"telefone"},"Telefone",-1),N=t("br",null,null,-1),q={class:"input-field"},T=t("label",{for:"perfil_img",style:{"margin-top":"10px"}},"Imagem de Perfil",-1),j=t("br",null,null,-1),A={key:0},B=["src"],S=t("br",null,null,-1),z={key:1},L=["src"],P=t("br",null,null,-1),R={type:"submit",class:"btn blue"};function Y(s,e,o,l,a,r){const _=g("mask");return u(),c("div",y,[t("h3",null,h(a.userId?"Editar Usuário":"Adicionar Novo Usuário"),1),t("form",{onSubmit:e[7]||(e[7]=p((...i)=>r.submitForm&&r.submitForm(...i),["prevent"]))},[t("div",I,[n(t("input",{"onUpdate:modelValue":e[0]||(e[0]=i=>a.form.nome=i),type:"text",id:"nome",required:""},null,512),[[m,a.form.nome]]),U]),t("div",x,[n(t("input",{"onUpdate:modelValue":e[1]||(e[1]=i=>a.form.email=i),type:"email",id:"email",required:""},null,512),[[m,a.form.email]]),w]),t("div",D,[n(t("input",{"onUpdate:modelValue":e[2]||(e[2]=i=>a.form.dt_nascimento=i),type:"date",id:"dt_nascimento",required:"",onChange:e[3]||(e[3]=(...i)=>r.formataDateIdade&&r.formataDateIdade(...i))},null,544),[[m,a.form.dt_nascimento]]),F]),t("div",k,[V,n(t("input",{"onUpdate:modelValue":e[4]||(e[4]=i=>a.idade=i),type:"text",disabled:""},null,512),[[m,a.idade]])]),t("div",C,[n(t("input",{"onUpdate:modelValue":e[5]||(e[5]=i=>a.form.telefone=i),type:"text",id:"telefone",required:""},null,512),[[m,a.form.telefone],[_,"(##) #########"]]),E]),N,t("div",q,[t("input",{type:"file",onChange:e[6]||(e[6]=(...i)=>r.handleFileChange&&r.handleFileChange(...i))},null,32),T]),j,a.perfil_img_preview?(u(),c("div",A,[t("img",{src:a.perfil_img_preview,alt:"Pré-visualização da Imagem",style:{width:"100px","max-height":"200px"}},null,8,B)])):f("",!0),S,a.perfil_img_carregado?(u(),c("div",z,[t("img",{src:"http://localhost/assets/img/"+a.perfil_img_carregado,alt:"User Icon",style:{width:"100px","max-height":"200px"}},null,8,L)])):f("",!0),P,t("button",R,h(a.userId?"Atualizar":"Adicionar"),1)],32)])}const J=b(v,[["render",Y]]);export{J as default};
