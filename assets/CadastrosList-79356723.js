import{D as d}from"./DataService-517babb4.js";import{r as v,f as D,o as c,c as m,a as t,g as u,v as h,h as C,F as g,i as y,t as p,b as N,w as k,d as x}from"./index-cf4a1cf1.js";import{_ as I}from"./_plugin-vue_export-helper-c27b6911.js";const S={name:"cadastros-list",data(){return{deleteId:null,dataModel:[],cadastros:[],searchNomeEmail:null,search:!1,searchDataInicio:null,searchDataFim:null,sortColumn:"",sortDirection:"asc"}},methods:{sortCadastros(){const s=[...this.cadastros],e=this.sortDirection==="desc"?-1:1,l=(i,n)=>{const o=i[this.sortColumn],r=n[this.sortColumn];return!isNaN(o)&&!isNaN(r)?(parseFloat(o)-parseFloat(r))*e:typeof o=="string"&&typeof r=="string"?o.localeCompare(r)*e:0};return s.sort(l)},limparSearch(){this.search=!1,this.searchDataInicio=null,this.searchDataFim=null,this.getCadastros()},sortTable(s){this.sortColumn===s?this.sortDirection=this.sortDirection==="asc"?"desc":"asc":(this.sortColumn=s,this.sortDirection="asc"),this.cadastros=this.sortCadastros()},getCadastros(){d.getAllCadastros(this.$route.query.page).then(s=>{this.cadastros=null,console.log(s.data.data),this.cadastros=s.data.data}).catch(s=>{console.log(s)})},clickSearchDataNascimento(){let s=this.searchDataInicio,e=this.searchDataFim;if(!/^\d{4}$/.test(s)||!/^\d{4}$/.test(e)){M.toast({html:"Os anos devem ser números válidos com 4 dígitos.",classes:"red toast-bottom-left"});return}if(s>e){M.toast({html:"O ano de início não pode ser posterior ao ano de término.",classes:"red toast-bottom-left"});return}d.cadastroSearchDataNascimento(s,e).then(l=>{console.log("data nascimento"),console.log(l.data.data),this.search=!0,this.cadastros=l.data.data}).catch(l=>{console.log(l)})},clickSearchNomeEmail(){d.cadastroSearchNomeEmail(this.searchNomeEmail).then(s=>{this.search=!0,this.cadastros=s.data.data.data,this.searchNomeEmail=null}).catch(s=>{console.log(s)})},openModalDelete(s){this.deleteId=s;const e=M.Modal.getInstance(document.getElementById("confirmModal"));e&&e.open()},confirmaDeleteCadastro(){d.deletarUsuario(this.deleteId).then(s=>{let e=s.data.message;M.toast({html:e,classes:"green toast-bottom-left"}),this.getCadastros()}).catch(s=>{let e=response.data.message;M.toast({html:e,classes:"red toast-bottom-left"}),console.log(s)})},formataDateIdade(s){if(!s)return"";const[e,l,i]=s.split("-"),n=`${i}/${l}/${e}`,o=this.calcularIdade(e,l,i);return`${n} (Idade: ${o} anos)`},calcularIdade(s,e,l){const i=new Date,n=new Date(s,e-1,l);return i.getFullYear()-n.getFullYear()},inputValidaAno(s,e){const l=s.target.value;l.length>4&&(s.target.value=l.slice(0,4),e==="start"?this.searchDataInicio=s.target.value:this.searchDataFim=s.target.value)}},mounted(){this.getCadastros(),M.Modal.init(document.querySelectorAll(".modal")),M.Tooltip.init(document.querySelectorAll("[data-tooltip]"),{position:"bottom"})}},E={class:""},F=t("br",null,null,-1),V={class:"row"},w=t("div",{class:"col s12 m12 l12",style:{"margin-bottom":"50px","margin-top":"10px"}},[t("a",{href:"/cadastro",class:"btn btn-primary"},"Adicionar um novo usuario")],-1),A={class:"col s12 m6 l6"},T={class:"input-field col s12 m19 l9"},q={class:"col s12 m6 l6"},U=t("p",{style:{"margin-top":"-5px","margin-left":"10px"}},"Pesquise por um intervalo de ano",-1),B={class:"input-field col s12 m4 l4",style:{"margin-top":"-20px"}},O={class:"input-field col s12 m4 l4",style:{"margin-top":"-20px"}},P=t("br",null,null,-1),L=t("br",null,null,-1),j={key:0,class:"input-group-append col s12 m12 l12",style:{"margin-top":"25px","margin-bottom":"25px"}},Y={class:"highlight striped"},z=t("th",null,"Foto",-1),G=t("th",null,"Email",-1),H=t("th",null,"Telefone",-1),J=t("th",null,"Ações",-1),K=["src"],Q=["onUpdate:modelValue"],R=["onClick"],W=t("br",null,null,-1),X={id:"confirmModal",class:"modal"},Z=t("div",{class:"modal-content"},[t("h4",null,"Confirmação"),t("p",null,"Tem certeza que deseja excluir este cadastro?")],-1),$={class:"modal-footer"},tt=t("button",{class:"modal-close waves-effect waves-red btn-flat"},"Não",-1);function et(s,e,l,i,n,o){const r=v("router-link"),b=D("mask");return c(),m(g,null,[t("div",E,[F,t("div",V,[w,t("div",A,[t("div",T,[u(t("input",{type:"text",class:"validate",placeholder:"Pesquise pelo nome ou email","onUpdate:modelValue":e[0]||(e[0]=a=>n.searchNomeEmail=a)},null,512),[[h,n.searchNomeEmail]])]),t("button",{class:"btn blue",type:"button",onClick:e[1]||(e[1]=(...a)=>o.clickSearchNomeEmail&&o.clickSearchNomeEmail(...a)),style:{"margin-top":"20px"}}," Pesquisar ")]),t("div",q,[U,t("div",B,[u(t("input",{type:"number",class:"validate","onUpdate:modelValue":e[2]||(e[2]=a=>n.searchDataInicio=a),placeholder:"Ano de Início",onInput:e[3]||(e[3]=a=>o.inputValidaAno(a,"start"))},null,544),[[h,n.searchDataInicio]])]),t("div",O,[u(t("input",{type:"number",class:"validate","onUpdate:modelValue":e[4]||(e[4]=a=>n.searchDataFim=a),placeholder:"Ano de Término",onInput:e[5]||(e[5]=a=>o.inputValidaAno(a,"end"))},null,544),[[h,n.searchDataFim]])]),t("button",{class:"btn blue",type:"button",onClick:e[6]||(e[6]=(...a)=>o.clickSearchDataNascimento&&o.clickSearchDataNascimento(...a)),style:{"margin-top":"-20px"}}," Pesquisar ")]),P,L,n.search==!0?(c(),m("div",j,[t("button",{class:"btn btn-outline-secondary",type:"button",onClick:e[7]||(e[7]=(...a)=>o.limparSearch&&o.limparSearch(...a))}," Limpar busca ")])):C("",!0),t("table",Y,[t("thead",null,[t("tr",null,[t("th",null,[t("button",{onClick:e[8]||(e[8]=a=>o.sortTable("id")),"data-tooltip":"Ordenar pelo ID",class:"btn"},"ID ")]),z,t("th",null,[t("button",{onClick:e[9]||(e[9]=a=>o.sortTable("nome")),"data-tooltip":"Ordenar pelo nome",class:"btn"},"Nome")]),G,t("th",null,[t("button",{onClick:e[10]||(e[10]=a=>o.sortTable("dt_nascimento")),"data-tooltip":"Ordenar pela data de nascimento",class:"btn"},"Data de Nascimento")]),H,J])]),t("tbody",null,[(c(!0),m(g,null,y(n.cadastros,(a,_)=>(c(),m("tr",{key:_},[t("td",null,p(a.id),1),t("td",null,[t("img",{src:"http://localhost/assets/img/"+a.perfil_img,alt:"User Icon",class:"responsive-img circle",style:{width:"50px",height:"50px"}},null,8,K)]),t("td",null,p(a.nome),1),t("td",null,p(a.email),1),t("td",null,p(o.formataDateIdade(a.dt_nascimento)),1),t("td",null,[u(t("input",{"onUpdate:modelValue":f=>a.telefone=f,disabled:"",type:"text"},null,8,Q),[[h,a.telefone],[b,"(##) #####-####"]])]),t("td",null,[N(r,{to:"/cadastro/"+a.id,class:"btn blue"},{default:k(()=>[x("Editar")]),_:2},1032,["to"]),t("button",{onClick:f=>o.openModalDelete(a.id),class:"btn red modal-trigger","data-target":"confirmModal"},"Excluir",8,R)])]))),128))])])]),W]),t("div",X,[Z,t("div",$,[t("button",{onClick:e[11]||(e[11]=(...a)=>o.confirmaDeleteCadastro&&o.confirmaDeleteCadastro(...a)),class:"modal-close waves-effect waves-green btn-flat"},"Sim"),tt])])],64)}const lt=I(S,[["render",et]]);export{lt as default};
